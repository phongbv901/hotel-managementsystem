@model HotelDAL.Product
@{
    ViewBag.Title = "Create";
}
<h3>
    Sản Phẩm</h3>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
@using (Html.BeginForm("Create", "Product", FormMethod.Post, new { enctype = "multipart/form-data" }))
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend></legend>
        <div class="editor-label">
            Tên Sản Phẩm
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.ProductName)
            @Html.ValidationMessageFor(model => model.ProductName)
        </div>
        <div class="editor-label">
            Giá Tiền
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Price)
            @Html.ValidationMessageFor(model => model.Price)
        </div>
        <div class="editor-label">
            Hình Ảnh
        </div>
        <span class="btn btn-success fileinput-button">
            <i class="icon-plus icon-white"></i>
            <span>Select files...</span>
            <!-- The file input field used as target for the file upload widget -->
            <input id="fileupload" type="file" name="files[]" multiple>
        </span>
        
       @* <div class="custom_file_upload">
            <input type="file" id="PicURL" name="PicURL" class="btn" />
        </div>*@
        <div class="editor-label">
            Danh Mục
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CatID)
            @Html.ValidationMessageFor(model => model.CatID)
        </div>
        <p>
            <input type="submit" value="Save" class="btn btn-success" />
            <a href="#myModal" role="button" class="open btn btn-success" data-toggle="modal" onclick="saveProduct()">Save
                With Composition</a>
        </p>
    </fieldset>
}
<div>
    @Html.ActionLink("Back to List", "ListProduct")
</div>
<!--Modal-->
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
    aria-hidden="true" style="height:700px;width:1000px; margin-left:-500px">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
            ×</button>
        <h3 id="myModalLabel">
            Thành Phần</h3>
    </div>
    <div class="modal-body">
        @Html.Action("listItem", "Product");
    </div>
    <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">
            Close</button>
        <button class="btn btn-primary" data-dismiss="modal" >
            Submit</button>
    </div>
</div>
<script type="text/javascript">
    function saveProduct() {
        var ProductName = document.getElementById("ProductName").value;
        var Price = document.getElementById("Price").value;
        var PicURL = document.getElementById("PicURL").value;
        var CatID = document.getElementById("CatID").value;
        $.ajax({
            url: "/Product/Create",
            type: "POST",
            data: { ProductName: ProductName, Price: Price, CatID: CatID, PicURL: PicURL },
            success: function (result) {
                alert("save ok");
            },
            error: function (result) {
                alert("save fail");
            }

        });
        
    }
</script>
<script>
    $(function () {
        $('#fileupload').fileupload({
            dataType: 'json',
            done: function (e, data) {
                $.each(data.result.files, function (index, file) {
                    $('<p/>').text(file.name).appendTo(document.body);
                });
            }
        });
    });
</script>


